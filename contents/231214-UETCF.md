# Using expressions that can fail

ì¼ì´ ì˜ ì§„í–‰ë˜ê³  ìˆì§€ë§Œ, ì•„ì§ ì‘ì€ ë¬¸ì œê°€ í•˜ë‚˜ ë” ìˆìŠµë‹ˆë‹¤.
ì‹¤íŒ¨í•  ìˆ˜ ìˆëŠ” í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?

ì•„ë˜ ì½”ë“œë¥¼ ë´ë´…ì‹œë‹¤.

```swift
import Foundation

func ifelse<V>(_ condition: Bool,
               _ valueTrue: @autoclosure () -> V,
               _ valueFalse: @autoclosure () -> V) -> V {
    condition ? valueTrue() : valueFalse()
}

func expensiveFailingValue1() throws -> Int {
  print("side-effect-1")
  return 2
}

func expensiveFailingValue2() throws -> Int {
  print("side-effect-2")
  return 1729
}

let taxicab = ifelse(.random(),
                     try expensiveFailingValue1(),
                     try expensiveFailingValue2())
```

ì´ê²ƒì€ `autoclosure`ê°€ ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” í´ë¡œì €ë¥¼ ì˜ˆìƒí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì»´íŒŒì¼ì— ì‹¤íŒ¨í•©ë‹ˆë‹¤.
ì»´íŒŒì¼ëŸ¬ë¡œë¶€í„°ì˜ íŠ¹ë³„í•œ ë„ì›€ ì—†ì´, ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ë¥¸ í•¨ìˆ˜ ë²„ì „ì„ ë§Œë“¤ì–´ í•´ê²°í•˜ë ¤ê³  í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```swift
func ifelseThrows<V>(_ condition: Bool,
                     _ valueTrue: @autoclosure () throws -> V,
                     _ valueFalse: @autoclosure () throws -> V) throws -> V {
    condition ? try valueTrue() : try valueFalse()
}

func expensiveFailingValue1() throws -> Int {
  print("side-effect-1")
  return 2
}

func expensiveFailingValue2() throws -> Int {
  print("side-effect-2")
  return 1729
}

let taxicab2 = try ifelseThrows(.random(),
                            try expensiveFailingValue1(),
                            try expensiveFailingValue2())

```

ì´ ì½”ë“œëŠ” ì‘ë™í•˜ì§€ë§Œ, ë³´ê¸°ì— ì¢‹ì§€ ì•ŠìŠµë‹ˆë‹¤.
ë‹¤í–‰íˆë„, ë” ë‚˜ì€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.
ë‹¤ì–‘í•œ ê²½ìš°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ì˜ í•œ ë²„ì „ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```swift
func ifelse<V>(_ condition: Bool,
                     _ valueTrue: @autoclosure () throws -> V,
                     _ valueFalse: @autoclosure () throws -> V) rethrows -> V {
    condition ? try valueTrue() : try valueFalse()
}
```

í•µì‹¬ì€ `rethrows`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
`Rethrows`ëŠ” ì‹¤íŒ¨í•œ í´ë¡œì €ì˜ ì˜¤ë¥˜ë¥¼ í˜¸ì¶œìì—ê²Œ ì „íŒŒí•©ë‹ˆë‹¤.
í´ë¡œì € ë§¤ê°œë³€ìˆ˜ ì¤‘ ì–´ëŠ ê²ƒë„ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•Šìœ¼ë©´, í•¨ìˆ˜ëŠ” ë¹„-ì˜ˆì™¸ í•¨ìˆ˜ë¡œ ê°„ì£¼ë˜ì–´ `'try'`ë¡œ í‘œì‹œí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

ì´ ë‹¨ì¼ ë²„ì „ì„ ì‚¬ìš©í•˜ë©´, ë‹¤ìŒê³¼ ê°™ì€ ëª¨ë“  ë³€í˜•ì´ ì‘ë™í•©ë‹ˆë‹¤.

```swift
func ifelse<V>(_ condition: Bool,
                     _ valueTrue: @autoclosure () throws -> V,
                     _ valueFalse: @autoclosure () throws -> V) rethrows -> V {
    condition ? try valueTrue() : try valueFalse()
}

func expensiveValue1() -> Int {
  print("side-effect-1")
  return 2
}

func expensiveValue2() -> Int {
  print("side-effect-2")
  return 1729
}

func expensiveFailingValue1() throws -> Int {
  print("side-effect-1")
  return 2
}

func expensiveFailingValue2() throws -> Int {
  print("side-effect-2")
  return 1729
}

let value = ifelse(.random(), 100, 0 )
let taxicab = ifelse(.random(),
                     expensiveValue1(),
                     expensiveValue2())
let taxicab2 = try ifelse(.random(),
                          try expensiveFailingValue1(),
                          try expensiveFailingValue2())
let taxicab3 = try ifelse(.random(),
                           expensiveValue1(),
                           try expensiveFailingValue2())
let taxicab4 = try ifelse(.random(),
                          try expensiveFailingValue1(),
                          expensiveValue2())
```

`ifelse` ë¥¼ ì™„ì„±í•˜ëŠ” ë° ê°€ê¹Œì›Œì§€ê³  ìˆìŠµë‹ˆë‹¤.
ì¶”ê°€ì ì¸ ì¶”ìƒí™” ê³„ì¸µì˜ ë¹„ìš©ì„ ì§€ë¶ˆí•˜ê³  ì‹¶ì§€ ì•Šê³ ,
êµ¬í˜„ì´ ê²°ì½” ë³€ê²½ë˜ì§€ ì•Šì„ ê²ƒì´ë¯€ë¡œ, í•¨ìˆ˜ë¥¼ `'@inlinable'`ë¡œ í‘œì‹œí•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ì…ë‹ˆë‹¤.
ì´ ì¶”ê°€ëœ í‚¤ì›Œë“œëŠ” ë©”ì„œë“œì˜ ë³¸ë¬¸ì´ í•¨ìˆ˜ í˜¸ì¶œì˜ ì˜¤ë²„í—¤ë“œ ì—†ì´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì§ì ‘ í¬í•¨ë˜ì–´ì•¼ í•¨ì„ ì»´íŒŒì¼ëŸ¬ì—ê²Œ ì•”ì‹œí•©ë‹ˆë‹¤.

```swift
@inlinable
func ifelse<V>(_ condition: Bool,
                     _ valueTrue: @autoclosure () throws -> V,
                     _ valueFalse: @autoclosure () throws -> V) rethrows -> V {
    condition ? try valueTrue() : try valueFalse()
}
```

> ğŸ“ Note.
> 
> `'@inlinable'` ë³´ë‹¤ ê°•ë ¥í•œ í˜•íƒœì˜ ì†ì„±ì´ ì‚¬ì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
> Swift ì†ŒìŠ¤ë¥¼ íƒìƒ‰í•˜ë©´ ì´ëŸ¬í•œ ì†ì„±ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ê·¸ ì¤‘ í•˜ë‚˜ëŠ” `'@_transparent'`ë¡œ, í•­ìƒ ê¸°ë³¸ êµ¬í˜„ì„ "íˆ¬ê³¼"í•˜ì—¬ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ì´ëŠ” `'-Onone'`ì—ì„œë„ ì¸ë¼ì¸ ì²˜ë¦¬ë¥¼ í•˜ë©°, ë””ë²„ê¹… ì‹œ ìŠ¤íƒ í”„ë ˆì„ì„ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> ì—¬ê¸°ì—ì„œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”: https://github.com/apple/swift/blob/main/docs/TransparentAttr.md
